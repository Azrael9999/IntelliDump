<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        x:Class="IntelliDump.MainWindow"
        Width="1100" Height="750"
        Title="IntelliDump Studio"
        Background="#0F1624"
        Padding="20">
  <Grid RowDefinitions="Auto,*,Auto" ColumnDefinitions="*">
    <Border Background="#16223a" CornerRadius="16" Padding="20" Margin="0,0,0,16">
      <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto">
        <StackPanel Spacing="6">
          <TextBlock Text="IntelliDump Studio" FontSize="28" FontWeight="SemiBold" Foreground="#7de5ff"/>
          <TextBlock Text="Offline, no-cloud IIS/.NET dump insights with PDF storytelling" Foreground="#c0d7ff" FontSize="14"/>
        </StackPanel>
        <StackPanel Orientation="Horizontal" Spacing="10" Grid.Column="1" VerticalAlignment="Center">
          <Button Content="Open Dump" Click="OpenDump_Click"/>
          <Button Content="Run Analysis" Click="Analyze_Click" Background="#4ade80"/>
          <Button Content="Export PDF" Click="ExportPdf_Click" Background="#a78bfa"/>
        </StackPanel>
        <StackPanel Grid.Row="1" Orientation="Horizontal" Spacing="10" Margin="0,12,0,0">
          <TextBlock Text="Dump:" Foreground="#c0d7ff" VerticalAlignment="Center"/>
          <TextBox Width="520" Text="{Binding DumpPath}" />
          <TextBlock Text="Stack threads" Foreground="#c0d7ff" VerticalAlignment="Center"/>
          <TextBox Width="60" Text="{Binding TopStackThreads}" />
          <TextBlock Text="Stack frames" Foreground="#c0d7ff" VerticalAlignment="Center"/>
          <TextBox Width="60" Text="{Binding MaxStackFrames}" />
          <TextBlock Text="Heap strings" Foreground="#c0d7ff" VerticalAlignment="Center"/>
          <TextBox Width="60" Text="{Binding HeapStrings}" />
        </StackPanel>
        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="10" Margin="0,12,0,0">
          <TextBlock Text="Thread strings" Foreground="#c0d7ff" VerticalAlignment="Center"/>
          <TextBox Width="60" Text="{Binding StackStrings}" />
          <TextBlock Text="Max string length" Foreground="#c0d7ff" VerticalAlignment="Center"/>
          <TextBox Width="80" Text="{Binding MaxStringLength}" />
          <TextBlock Text="Heap histogram" Foreground="#c0d7ff" VerticalAlignment="Center"/>
          <TextBox Width="60" Text="{Binding HeapHistogram}" />
        </StackPanel>
      </Grid>
    </Border>

    <Grid Grid.Row="1" ColumnDefinitions="2*,3*">
      <Border Background="#16223a" CornerRadius="16" Padding="16">
        <StackPanel Spacing="10">
          <TextBlock Text="Status" Foreground="#7de5ff" FontSize="18" FontWeight="SemiBold"/>
          <TextBlock Text="{Binding Status}" Foreground="#c0d7ff" TextWrapping="Wrap"/>
          <TextBlock Text="Findings" Foreground="#7de5ff" FontSize="18" FontWeight="SemiBold" Margin="0,12,0,0"/>
          <ScrollViewer Height="260">
            <ItemsControl ItemsSource="{Binding Findings}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Border Margin="0,6,0,6" Padding="10" CornerRadius="10"
                          Background="{Binding SeverityColor}">
                    <StackPanel>
                      <TextBlock Text="{Binding Title}" FontWeight="SemiBold"/>
                      <TextBlock Text="{Binding Evidence}" TextWrapping="Wrap"/>
                      <TextBlock Text="{Binding Recommendation}" TextWrapping="Wrap" FontStyle="Italic"/>
                    </StackPanel>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </ScrollViewer>
        </StackPanel>
      </Border>

      <Border Background="#16223a" CornerRadius="16" Padding="16">
        <StackPanel Spacing="10">
          <TextBlock Text="Highlights" Foreground="#7de5ff" FontSize="18" FontWeight="SemiBold"/>
          <TextBlock Text="{Binding HighlightSummary}" Foreground="#c0d7ff" TextWrapping="Wrap"/>
          <TextBlock Text="Threads &amp; GC" Foreground="#7de5ff" FontSize="18" FontWeight="SemiBold" Margin="0,12,0,0"/>
          <TextBlock Text="{Binding ThreadsSummary}" Foreground="#c0d7ff" TextWrapping="Wrap"/>
          <TextBlock Text="{Binding GcSummary}" Foreground="#c0d7ff" TextWrapping="Wrap"/>
          <TextBlock Text="PDF Output" Foreground="#7de5ff" FontSize="18" FontWeight="SemiBold" Margin="0,12,0,0"/>
          <TextBlock Text="{Binding PdfPath}" Foreground="#c0d7ff" TextWrapping="Wrap"/>
        </StackPanel>
      </Border>
    </Grid>

    <TextBlock Grid.Row="2" HorizontalAlignment="Center" Foreground="#6b7280" Margin="0,10,0,0"
               Text="IntelliDump runs fully offline â€¢ powered by CLRMD + QuestPDF + Avalonia"
               FontSize="12"/>
  </Grid>
</Window>
